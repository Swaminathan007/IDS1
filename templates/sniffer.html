{%extends "base.html"%}
{%block title%}Packet Sniffer{%endblock%}
{%block content%}
{%include "navbar.html"%}
<div class="container">
    <h1 class="mt-4 mb-4">Captured Network Traffic</h1>
    <button id="startSniffing" class="btn btn-primary mb-4">Start Sniffing</button>
    <button id="stopSniffing" class="btn btn-danger mb-4" disabled>Stop Sniffing</button>
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <th>Timestamp</th>
                <th>Source IP</th>
                <th>Destination IP</th>
                <th>Protocol</th>
                <th>Interface</th>
            </tr>
        </thead>
        <tbody id="traffic_table">
            <!-- New rows will be inserted here -->
        </tbody>
    </table>
</div>

<!-- Save Capture Modal -->
<div class="modal fade" id="saveCaptureModal" tabindex="-1" role="dialog" aria-labelledby="saveCaptureModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="saveCaptureModalLabel">Save Capture</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Do you want to save the capture file?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                <button type="button" class="btn btn-primary" id="confirmSave">Yes</button>
            </div>
        </div>
    </div>
</div>

<!-- Packet Details Modal -->
<div class="modal fade" id="packetDetailsModal" tabindex="-1" role="dialog" aria-labelledby="packetDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="packetDetailsModalLabel">Packet Details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <pre id="packetDetailsContent"></pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

</div>
</div>
</main>
</div>
</div>



{%endblock%}